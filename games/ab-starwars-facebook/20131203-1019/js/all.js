config.feedImageVersion="1";var protocol="https:"==document.location.protocol?"https:":"http:";var stringConstants={CROWN_BRONZE:"bronze",CROWN_SILVER:"silver",CROWN_GOLD:"gold",SHARE_THREE_STARS_TITLE:"Three Star Club!",SHARE_THREE_STARS_LINE1:"I just aced %1 with my skills and got %2 points.",SHARE_THREE_STARS_LINE2:"",SHARE_CROWN_TITLE:"All hail the mighty ruler!",SHARE_CROWN_LINE1:"I just owned %2 and won a %1 crown with %3 points.",SHARE_CROWN_LINE2:"",SHARE_TOURNAMENT_1ST_TITLE:"Gold Leader!",SHARE_TOURNAMENT_1ST_LINE1:"I got %1 points and beat all my friends in the Angry Birds Star Wars Weekly Tournament.",SHARE_TOURNAMENT_1ST_LINE2:"Think you can beat me in the next Tournament?",SHARE_TOURNAMENT_2ND_TITLE:"Silver Starfighter!",SHARE_TOURNAMENT_2ND_LINE1:"I took second place in the Angry Birds Star Wars Weekly Tournament with %1 points.",SHARE_TOURNAMENT_2ND_LINE2:"Come and challenge me in the next Tournament!",SHARE_TOURNAMENT_3RD_TITLE:"Bronze Master!",SHARE_TOURNAMENT_3RD_LINE1:"I won the bronze trophy in the Angry Birds Star Wars Weekly Tournament with %1 points.",SHARE_TOURNAMENT_3RD_LINE2:"Come play with me in the next Tournament!",SHARE_MEDAL_GOLD_TITLE:"Total destruction!",SHARE_MEDAL_GOLD_LINE1:"I just obliterated %1 with the Mighty Falcon.",SHARE_MEDAL_GOLD_LINE2:"Click play to try the level yourself!",SHARE_DEFAULT_TITLE:"Angry Birds Star Wars",SHARE_DEFAULT_LINE1:"I just %1 %2 in Angry Birds Star Wars!",SHARE_DEFAULT_LINE2:"Click the icon to play the level.",SHARE_AVATAR_TITLE:"I made a new avatar!",INVITE_TITLE:"Select friends to invite",INVITE_MESSAGE:"Squawk! Join the Rebellion and compete against your friends in Angry Birds Star Wars!",SEND_GIFTS_FRIEND_SELECTOR_TITLE:"Select which friends to send free Crystals to",SEND_GIFTS_SINGLE_TITLE:"Send a gift to your friend.",SEND_GIFTS_MESSAGE:"%1 just sent you a Crystal. Claim it now!",SEND_HELP_REQUEST_FRIEND_SELECTOR_TITLE:"Ask selected friends for Crystals",SEND_HELP_REQUEST_SINGLE_TITLE:"Ask your friend to send you a Crystal.",SEND_HELP_REQUEST_MESSAGE:"%1 needs your assistance! Click to help them out and send a Crystal!",BRAG_TITLE:"Let your friends know you have beaten their score",BRAG_MESSAGE:"I beat your high score in %1 in Angry Birds Star Wars! Think you can beat mine?",CHALLENGE_TITLE:"Ask your friend to join the Tournament!",CHALLENGE_MESSAGE:"%1 challenged you to the Angry Birds Star Wars Weekly Tournament. Can you beat their score?"};var permissions={};function deleteAllRequests(){var a=getURLParameter("request_ids");if(a&&a!="null"){var b=a.split("%2C");$.each(b,function(){FB.api(this+"_"+config.userId,"delete",function(c){})})}}function updatePermissions(a){FB.api("/me/permissions",function(b){permissions=b.data[0];if(a){a()}})}function placeOrder(a){FB.ui({method:"pay",action:"purchaseitem",product:protocol+"//apps.facebook.com/"+config.appDomain+"/open_graph/object/OGProduct/"+a,quantity:1},orderCallback)}function onUrl(a){document.getElementById("AngryBirdsBlack").onUrl(a.path)}var widthToggle=true;var orderCallback=function(a){onUIDialogClose();if(a.payment_id&&a.quantity&&a.status){document.getElementById("AngryBirdsBlack").purchaseComplete()}};function sharePhoto(a){pauseGame();FB.ui({method:"feed",link:protocol+"//apps.facebook.com/"+config.appDomain,picture:protocol+"//facebook.com/photo.php?fbid="+a,name:stringConstants.SHARE_AVATAR_TITLE,ref:"avatar"},onUIDialogClose)}function shareThreeStars(b,a,d){pauseGame();var c=protocol+"//apps.facebook.com/"+config.appDomain+"/?levelId="+b+"&ref=stars";FB.ui({method:"stream.publish",user_message_prompt:"",message:"message",ref:"stars",attachment:{name:stringConstants.SHARE_THREE_STARS_TITLE.replace("%1",a),caption:stringConstants.SHARE_THREE_STARS_LINE1.replace("%1",a).replace("%2",d),description:stringConstants.SHARE_THREE_STARS_LINE2,href:c,media:[{type:"image",src:getShareImageUrl("stars.png",b),href:c}]}},onShareUIDialogClose("stars",b))}function shareGoldMedal(b,a){pauseGame();var d="medal_gold";var c=protocol+"//apps.facebook.com/"+config.appDomain+"/?levelId="+b+"&ref="+d;FB.ui({method:"stream.publish",user_message_prompt:"",message:"message",ref:d,attachment:{name:stringConstants.SHARE_MEDAL_GOLD_TITLE,caption:stringConstants.SHARE_MEDAL_GOLD_LINE1.replace("%1",a),description:stringConstants.SHARE_MEDAL_GOLD_LINE2,href:c,media:[{type:"image",src:getShareImageUrl("share_medal_gold.png",b),href:c}]}},onShareUIDialogClose(d,b))}function shareDefault(b,a,e,d){pauseGame();var c=protocol+"//apps.facebook.com/"+config.appDomain+"/?levelId="+b+"&ref=play";FB.ui({method:"stream.publish",user_message_prompt:"",message:"message",ref:"play",attachment:{name:stringConstants.SHARE_DEFAULT_TITLE,caption:stringConstants.SHARE_DEFAULT_LINE1.replace("%1",(d?"beat":"played")).replace("%2",a),description:stringConstants.SHARE_DEFAULT_LINE2,href:c,media:[{type:"image",src:getShareImageUrl("share_level_complete.jpg",b),href:c}]}},onShareUIDialogClose(d?"win":"lose",b))}function shareCrown(c,b,f,e){if(f>=1&&f<=3){var a=[stringConstants.CROWN_GOLD,stringConstants.CROWN_SILVER,stringConstants.CROWN_BRONZE][f-1];var d=protocol+"//apps.facebook.com/"+config.appDomain+"/?levelId="+c+"&ref=crown";pauseGame();FB.ui({method:"stream.publish",user_message_prompt:"",message:"message",ref:"crown",attachment:{name:stringConstants.SHARE_CROWN_TITLE,caption:stringConstants.SHARE_CROWN_LINE1.replace("%1",a).replace("%2",b).replace("%3",e),description:stringConstants.SHARE_CROWN_LINE2,href:d,media:[{type:"image",src:getShareImageUrl("share_crown_"+a+".png",c),href:d}]}},onShareUIDialogClose("crown",c))}}function getShareImageUrl(b,a){return config.serverRoot+"/fb_images/"+b+"?v="+config.feedImageVersion}function onShareUIDialogClose(a,b){return function(c){if(c){trackEvent1Percent("share",a,b);if(a=="crown"){document.getElementById("AngryBirdsBlack").crownShared()}else{if(a=="tournament"){document.getElementById("AngryBirdsBlack").tournamentRankShared()}}}onUIDialogClose(c)}}function shareTournamentRank(e,b){pauseGame();var d,f,a;var c;switch(e){case 1:d=stringConstants.SHARE_TOURNAMENT_1ST_TITLE;f=stringConstants.SHARE_TOURNAMENT_1ST_LINE1;a=stringConstants.SHARE_TOURNAMENT_1ST_LINE2;c="share_trophy_gold.png";break;case 2:d=stringConstants.SHARE_TOURNAMENT_2ND_TITLE;f=stringConstants.SHARE_TOURNAMENT_2ND_LINE1;a=stringConstants.SHARE_TOURNAMENT_2ND_LINE2;c="share_trophy_silver.png";break;case 3:d=stringConstants.SHARE_TOURNAMENT_3RD_TITLE;f=stringConstants.SHARE_TOURNAMENT_3RD_LINE1;a=stringConstants.SHARE_TOURNAMENT_3RD_LINE2;c="share_trophy_bronze.png";break}FB.ui({method:"feed",link:protocol+"//apps.facebook.com/"+config.appDomain+"/?ref=tournament",picture:config.serverRoot+"/fb_images/"+c+"?v="+config.feedImageVersion,name:d,caption:f.replace("%1",b),description:a,ref:"tournament"},onShareUIDialogClose("tournament",e))}function flashInviteFriendsHandler(a){var b={method:"apprequests",filters:["app_non_users"],title:stringConstants.INVITE_TITLE,message:stringConstants.INVITE_MESSAGE,ref:"invite"};if(a){b.to=a}pauseGame();FB.ui(b,onInvitationDialogClose)}function onInvitationDialogClose(a){onUIDialogClose(a);if(a&&a.to){document.getElementById("AngryBirdsBlack").invitationBatchSent(a.to);var b="/invitationsent/"+encodeURIComponent(a.to)+"?st="+getSessionToken();$.get(b);var c=a.to?a.to.length:0;trackEvent1Percent("invite","invitation-sent",""+c,c)}else{}}function flashShowFirstTimePayerPromotion(){pauseGame();var a={method:"fbpromotion",display:"popup",package_name:"zero_promo",product:protocol+"//apps.facebook.com/"+config.appDomain+"/open_graph/object/OGCredit"};FB.ui(a,onFirstTimePayerPromotion)}function flashSendGiftToFriends(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.SEND_GIFTS_FRIEND_SELECTOR_TITLE,message:stringConstants.SEND_GIFTS_MESSAGE.replace("%1",b),ref:"gift"},onGiftSent)}function flashSendGiftFriend(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.SEND_GIFTS_SINGLE_TITLE,message:stringConstants.SEND_GIFTS_MESSAGE.replace("%1",b),ref:"gift"},onGiftSent)}function flashSendHelpRequestToFriends(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.SEND_HELP_REQUEST_FRIEND_SELECTOR_TITLE,message:stringConstants.SEND_HELP_REQUEST_MESSAGE.replace("%1",b),ref:"help"},onHelpSent)}function flashSendHelpRequestFriend(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.SEND_HELP_REQUEST_SINGLE_TITLE,message:stringConstants.SEND_HELP_REQUEST_MESSAGE.replace("%1",b),ref:"help"},onHelpSent)}function flashSendChallengeFriend(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.CHALLENGE_TITLE,message:stringConstants.CHALLENGE_MESSAGE.replace("%1",b),ref:"challenge"},onChallengeSent)}function flashSendChallengeToFriends(b,a){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.CHALLENGE_TITLE,message:stringConstants.CHALLENGE_MESSAGE.replace("%1",b),ref:"challenge"},onChallengeSent)}function onChallengeSent(a){onUIDialogClose(a);if(a!==undefined&&a.request!==undefined){document.getElementById("AngryBirdsBlack").challengeSent(a.to);var b="/bragrequestsent/"+a.request+"/t_challenge/"+encodeURIComponent(a.to)+"?st="+getSessionToken();$.get(b);trackEvent1Percent("challenge","challenge-sent",null,0)}}function onFirstTimePayerPromotion(a){onUIDialogClose(a);if(a!==undefined&&a.request!==undefined){document.getElementById("AngryBirdsBlack").newPayerPromotionSent(a.to);trackEvent10Percent("newpayer","newpayer-promotion-sent",null,0)}}function onGiftSent(a){if(a==undefined||a.request==undefined){resumeGame(false);return}onUIDialogClose(a);if(a!==undefined&&a.request!==undefined){document.getElementById("AngryBirdsBlack").giftsSentToUsers(a.to);var b="/giftrequestsent/"+a.request+"/"+encodeURIComponent(a.to)+"?st="+getSessionToken();$.get(b);trackEvent1Percent("gift","gift-sent",null,0)}}function onHelpSent(a){onUIDialogClose(a);if(a!==undefined&&a.request!==undefined){document.getElementById("AngryBirdsBlack").helpRequestSentToUsers(a.to);var b="/helprequestsent/"+a.request+"/"+encodeURIComponent(a.to)+"?st="+getSessionToken();$.get(b);trackEvent1Percent("gift","help-request-sent",null,0)}}function flashBrag(a,c,b){pauseGame();FB.ui({method:"apprequests",to:a,title:stringConstants.BRAG_TITLE,message:stringConstants.BRAG_MESSAGE.replace("%1",b),ref:"brag"},function(d){onUIDialogClose(d);if(d!==undefined&&d.request!==undefined){var e="/bragrequestsent/"+d.request+"/"+c+"/"+encodeURIComponent(d.to)+"?st="+getSessionToken();$.get(e)}})}function askForPublishStreamPermission(){if(permissions.publish_stream){document.getElementById("AngryBirdsBlack").permissionRequestComplete("true")}else{FB.login(function(a){updatePermissions(function(){if(permissions.publish_stream){document.getElementById("AngryBirdsBlack").permissionRequestComplete("true")}else{document.getElementById("AngryBirdsBlack").permissionRequestComplete("false")}})},{scope:"publish_stream"})}}function flashDeleteRequest(a){FB.api(a,"delete",function(b){})}function login(a){postLogin()}function onUIDialogClose(a){resumeGame(true)}function requestAuthorization(){window.location.replace("/fbauth/authRequest"+window.location.search)}function logout(){window.location.replace("/logout")}function getSessionToken(){return document.getElementById("AngryBirdsBlack").getSessionToken()}function getTips(){return config.loadingTips}function renewAccessToken(){FB.getLoginStatus(function(a){if(a.status==="connected"){config.accessToken=a.authResponse.accessToken;config.tokenExpiresIn=a.authResponse.expiresIn;document.getElementById("AngryBirdsBlack").accessTokenRenewed(config.accessToken)}else{document.getElementById("AngryBirdsBlack").error("Could not renew access token. Status: '"+a.status+"'.")}})};
var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-23082676-35"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();var sample1Percent=Math.random();var sample10Percent=Math.random();function trackEvent10Percent(a,c,b,d){if(sample10Percent<=0.1){trackEvent(a,c+" x 10",b,d)}}function trackEvent1Percent(a,c,b,d){if(sample1Percent<=0.01){trackEvent(a,c+" x 100",b,d)}}function trackEvent(a,c,b,d){if(a==null){return}if(c==null){c=""}if(b==null){b=""}if(d==null){_gaq.push(["_trackEvent",a,c,b])}else{_gaq.push(["_trackEvent",a,c,b,d])}};
FB.init({appId:config.appId,channelURL:config.channelURL,status:true,cookie:false,oauth:true,xfbml:true,frictionlessRequests:true,hideFlashCallback:onFbVisibilityUpdate});FB.getLoginStatus(function(a){if(a.status==="connected"){config.accessToken=a.authResponse.accessToken;config.userId=a.authResponse.userID;config.tokenExpiresIn=a.authResponse.expiresIn;document.getElementById("accessToken").innerHTML="Access Token: "+config.accessToken;login(a)}else{if(a.status==="not_authorized"){requestAuthorization()}else{logout()}}});FB.Canvas.setSize();
var pausePending=false;var gameIsPaused=false;function onFlashLoadComplete(){FB.Canvas.setDoneLoading()}function onFbVisibilityUpdate(a){if(a.state=="opened"){pauseGame()}else{resumeGame(true)}}function getURLParameter(a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function pauseGame(){if(pausePending||gameIsPaused){return}pausePending=true;gameIsPaused=true;document.getElementById("AngryBirdsBlack").pause();document.getElementById("screenshot").style.display="none";document.getElementById("flashContent").style.top="-10000px";document.getElementById("imageContent").style.top="";document.getElementById("pauseLoading").style.display=""}function flashScreenshotReadyHandler(c){if(pausePending){pausePending=false}else{return}var e=document.getElementById("imageContent");var a=document.getElementById("flashContent");var b=document.getElementById("screenshot");document.getElementById("pauseLoading").style.display="none";var d="data:image/jpeg;base64,"+c;b.src=d.toString();b.style.display=""}function resumeGame(a){if(!gameIsPaused){return}document.getElementById("flashContent").style.top="";document.getElementById("imageContent").style.top="-10000px";document.getElementById("screenshot").style.display="none";if(a){document.getElementById("AngryBirdsBlack").resume()}else{document.getElementById("AngryBirdsBlack").resumeOnError()}pausePending=false;gameIsPaused=false}function flashRequestPauseHandler(){pauseGame()}function loadMainClient(c){var d={allowScriptAccess:"always",wmode:"direct",allowFullScreen:"true",bgcolor:"#000000"};var b={id:"AngryBirdsBlack",name:"AngryBirdsBlack"};var a={assetsUrl:config.assetsUrl,serverVersion:config.serverVersion,serverRoot:config.serverRoot,accessToken:config.accessToken,userId:config.userId,tokenExpiresIn:config.tokenExpiresIn,acquisitionChannel:config.acquisitionChannel};if(config.levelId){a.levelId=config.levelId}c.embedSWF(config.assetsUrl+"AngryBirdsBlackFacebook.swf","flashHolder","100%","570","11.0.0",config.assetsUrl+"playerProductInstall.swf",a,d,b);c.createCSS("#flashHolder","display: block;");document.getElementById("imageContent").style.top="-10000px";document.getElementById("imageContent").style.display="block";trackEvent10Percent("flash","embed")}function postLogin(){var b=getURLParameter("request_ids");if(b&&b!="null"){var d=b.split("%2C");if(d.length==1){var c=b+"_"+config.userId;var a="https://graph.facebook.com/"+c+"?access_token="+config.accessToken;$.get(a,null,"json").complete(function(e){config.levelId=e.data;loadMainClient(swfobject);deleteAllRequests();updatePermissions()})}else{loadMainClient(swfobject);deleteAllRequests();updatePermissions()}}else{loadMainClient(swfobject);updatePermissions()}}function flashGetAccessToken(){return config.accessToken}function flashGetUserId(){return config.userId};
(function(){if(window.SWFWheel){return}var c=window,b=document,d=navigator;var a=window.SWFWheel=function(e){this.setUp(e);if(a.browser.msie){this.bind4msie()}else{this.bind()}};a.prototype={setUp:function(f){var e=a.retrieveObject(f);if(e.nodeName.toLowerCase()=="embed"||a.browser.safari){e=e.parentNode}this.target=e;this.eventType=a.browser.mozilla?"DOMMouseScroll":"mousewheel"},bind:function(){this.target.addEventListener(this.eventType,function(e){var h,g,i=0;if(/XPCNativeWrapper/.test(e.toString())){var f=e.target.getAttribute("id")||e.target.getAttribute("name");if(!f){return}h=a.retrieveObject(f)}else{h=e.target}g=h.nodeName.toLowerCase();if(g!="object"&&g!="embed"){return}if(!h.checkBrowserScroll()){e.preventDefault();e.returnValue=false}if(!h.triggerMouseEvent){return}switch(true){case a.browser.mozilla:i=-e.detail;break;case a.browser.opera:i=e.wheelDelta/40;break;default:i=e.wheelDelta/80;break}h.triggerMouseEvent(i,e.ctrlKey,e.altKey,e.shiftKey)},false)},bind4msie:function(){var g,e,f=this.target;g=function(){var h=c.event,j=0,i=h.srcElement.nodeName.toLowerCase();if(i!="object"&&i!="embed"){return}if(!f.checkBrowserScroll()){h.returnValue=false}if(!f.triggerMouseEvent){return}j=h.wheelDelta/40;f.triggerMouseEvent(j,h.ctrlKey,h.altKey,h.shiftKey)};e=function(){if(f.detachEvent!=null){f.detachEvent("onmousewheel",g)}c.detachEvent("onunload",e)};f.attachEvent("onmousewheel",g);c.attachEvent("onunload",e)}};a.browser=(function(){var h=d.userAgent.toLowerCase(),i=d.platform.toLowerCase(),f,j=[0,0,0];if(d.plugins&&d.plugins["Shockwave Flash"]){f=d.plugins["Shockwave Flash"].description.replace(/^.*\\s+(\\S+\\s+\\S+$)/,"$1");j[0]=parseInt(f.replace(/^(.*)\\..*$/,"$1"),10);j[1]=parseInt(f.replace(/^.*\\.(.*)\\s.*$/,"$1"),10);j[2]=/[a-z-A-Z]/.test(f)?parseInt(f.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else{if(c.ActiveXObject){try{var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(g){f=g.GetVariable("$version");if(f){f=f.split(" ")[1].split(",");j[0]=parseInt(f[0],10);j[1]=parseInt(f[1],10);j[2]=parseInt(f[2],10)}}}catch(k){}}}return{win:i?/win/.test(i):/win/.test(h),mac:i?/mac/.test(i):/mac/.test(h),playerVersion:j,version:(h.match(/.+(?:rv|it|ra|ie)[\/:\\s]([\\d.]+)/)||[0,"0"])[1],chrome:/chrome/.test(h),stainless:/stainless/.test(h),safari:/webkit/.test(h)&&!/(chrome|stainless)/.test(h),opera:/opera/.test(h),msie:/msie/.test(h)&&!/opera/.test(h),mozilla:/mozilla/.test(h)&&!/(compatible|webkit)/.test(h)}})();a.join=function(f){var e=setInterval(function(){if(a.retrieveObject(f)){clearInterval(e);new a(f)}},0)};a.getState=function(f){var s=2,o=1,t=0,r=a.browser,q=r.playerVersion;if(r.chrome||r.msie){return s}if(r.mac){if(q[0]>=10&&q[1]>=1){if(r.safari||r.stainless){return t}else{if(r.chrome){return o}else{return s}}}else{return s}}if(!(q[0]>=10&&q[1]>=1)&&a.browser.safari){return s}var h=a.retrieveObject(f),e=h.nodeName.toLowerCase(),g="";if(e=="object"){var m,j,l=h.getElementsByTagName("param"),p=l.length;for(var n=0;n<p;n++){j=l[n];if(j.parentNode!=h){continue}m=j.getAttribute("name");g=j.getAttribute("value")||"";if(/wmode/i.test(m)){break}}}else{if(e=="embed"){g=h.getAttribute("wmode")||""}}if(r.msie){if(/transparent/i.test(g)){return s}else{if(/opaque/i.test(g)){return o}else{return t}}}else{if(/opaque|transparent/i.test(g)){return s}else{return t}}};a.retrieveObject=function(j){var h=b.getElementById(j);if(!h){var f=b.getElementsByTagName("embed"),e=f.length;for(var g=0;g<e;g++){if(f[g].getAttribute("name")==j){h=f[g];break}}}return h}})();
